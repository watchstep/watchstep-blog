{{ define "main" }}
<div class="row justify-content-center">
  <div class="col-md-12 col-lg-9">
    {{ if .Params.avatar -}}
      {{ $image := .Resources.GetMatch (printf "**%s" .Params.avatar) -}}
      {{ $imageLq := $image.Resize "15x15 webp q95" -}}
      {{ $image = $image.Resize "300x300 webp q95" -}}
      <div class="contributor-image">
        <img class="img-fluid lazyload blur-up rounded-circle"
             src="{{ $imageLq.RelPermalink }}" data-src="{{ $image.RelPermalink }}"
             alt="{{ .Title }}" width="150" height="150">
      </div>
    {{ end -}}
    {{ with .Params.headline -}}
      <h1 class="text-center">{{ . }}</h1>
    {{ else -}}
      <h1 class="text-center">{{ .Title }}</h1>
    {{ end -}}
    {{ with .Params.summary -}}<p class="lead text-center">{{ . }}</p>{{ end -}}
    {{ with .Content -}}<div class="text-center">{{ . }}</div>{{ end -}}
  </div>
</div>

<div class="row justify-content-center">
  <div class="col-lg-9">
    {{ $paginator := .Paginate (.Data.Pages) -}}
    {{ range $paginator.Pages -}}
      <div class="card">
        {{ if site.Params.doks.imageList -}}
          {{- $images := .Resources.ByType "image" -}}
          {{- $featured := $images.GetMatch "*feature*" -}}
          {{- if not $featured }}{{ $featured = $images.GetMatch "{*cover*,*thumbnail*}" }}{{ end -}}
          {{- if $featured -}}
            {{ partial "img" (dict "page" . "src" $featured "alt" .Title "class" "rounded-top-1") }}
          {{ end -}}
        {{ end -}}

        <div class="card-body">
          <article>
            <h2 class="h3">
              {{- $ext := or .Params.externalurl .Params.externalUrl -}}
              {{- if $ext -}}
                <a class="stretched-link text-body"
                   href="{{ $ext }}" target="_blank"
                   rel="noopener noreferrer nofollow"
                   aria-label="{{ .Params.title }} (opens in a new tab)">
                   {{ .Params.title }}
                </a>
              {{- else -}}
                <a class="stretched-link text-body" href="{{ .RelPermalink }}">{{ .Params.title }}</a>
              {{- end -}}
            </h2>

            {{ with .Params.summary -}}
              <p>{{ . | safeHTML }}</p>
            {{ end -}}

            {{/* meta(날짜/읽기시간 등) — 파셜로 위임 (읽기시간 노출여부는 파셜 내부에서 결정) */}}
            {{ partial "main/blog-meta.html" . }}
          </article>
        </div>
      </div>
    {{ end -}}
  </div>
</div>

<div class="row justify-content-center">
  <div class="col-md-12 col-lg-9">
    {{ template "_internal/pagination.html" . }}
  </div>
</div>
{{ end }}
